{% extends "base.html" %}

{% block title %}{{ title }}{% endblock %}

{% block extra_css %}
<style>
    /* Estilos para la lista de formularios */
    body {
        background-color: #f8f9fa;
        background-image: linear-gradient(135deg, #f5f7fa 0%, #e4eaec 100%);
    }
    
    .breadcrumb-section {
        padding: 1rem 0;
        background-color: rgba(255, 255, 255, 0.5);
        backdrop-filter: blur(5px);
        border-radius: 10px;
        margin-bottom: 1.5rem;
    }
    
    .breadcrumb {
        margin-bottom: 0;
        padding: 0.5rem 1rem;
    }
    
    .page-header {
        position: relative;
        margin-bottom: 2.5rem;
        border-radius: 15px;
        overflow: hidden;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    }
    
    .page-header-bg {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image: url("{{ url_for('static', filename=(menu_item.image_path if menu_item is not mapping else menu_item['image_path']).replace('\\\\', '/')) }}");
        background-size: cover;
        background-position: center;
        filter: blur(0px);
        transform: scale(1.1);
        z-index: -1;
    }
    
    .page-header-overlay {
        background: linear-gradient(90deg, 
            rgba(var(--section-color-rgb), 0.95) 0%, 
            rgba(var(--section-color-rgb), 0.7) 100%);
        padding: 2.5rem 0;
    }
    
    .page-title {
        font-size: 2.2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
        color: white;
        display: flex;
        align-items: center;
    }
    
    .page-title i {
        margin-right: 0.8rem;
        font-size: 2rem;
    }
    
    .page-description {
        font-size: 1.1rem;
        color: rgba(255,255,255,0.9);
        margin-bottom: 0;
    }
    
    .nav-buttons {
        display: flex;
        gap: 10px;
        margin-bottom: 1.5rem;
    }
    
    .nav-button {
        border-radius: 50px;
        padding: 0.6rem 1.2rem;
        font-weight: 500;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        background-color: white;
        border: none;
        display: flex;
        align-items: center;
    }
    
    .nav-button:hover {
        transform: translateX(-5px);
        box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    
    .nav-button i {
        margin-right: 0.5rem;
    }
    
    .forms-container {
        position: relative;
        margin-top: -20px;
        z-index: 10;
    }
    
    .form-card {
        border-radius: 12px;
        overflow: hidden;
        transition: all 0.3s ease;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
        margin-bottom: 1.5rem;
        border: none;
    }
    
    .form-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 30px rgba(0,0,0,0.1);
    }
    
    .form-card-header {
        background-color: #fff;
        border-bottom: 1px solid rgba(0,0,0,0.05);
        padding: 1.25rem;
    }
    
    .form-card-title {
        font-size: 1.25rem;
        font-weight: 600;
        margin-bottom: 0.25rem;
        color: #343a40;
    }
    
    .form-card-subtitle {
        font-size: 0.875rem;
        color: #6c757d;
    }
    
    .form-card-body {
        padding: 1.25rem;
        background-color: #fff;
    }
    
    .form-card-description {
        color: #495057;
        margin-bottom: 1rem;
    }
    
    .form-card-footer {
        background-color: #f8f9fa;
        border-top: 1px solid rgba(0,0,0,0.05);
        padding: 1rem 1.25rem;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    
    .form-meta {
        display: flex;
        gap: 1rem;
        color: #6c757d;
        font-size: 0.875rem;
    }
    
    .form-meta i {
        margin-right: 0.25rem;
    }
    
    .form-actions {
        display: flex;
        gap: 0.5rem;
    }
    
    .action-button {
        padding: 0.375rem 0.75rem;
        border-radius: 50px;
        font-size: 0.875rem;
        transition: all 0.2s ease;
    }
    
    .action-button:hover {
        transform: translateY(-2px);
    }
    
    .badge-active {
        background-color: #28a745;
    }
    
    .badge-inactive {
        background-color: #6c757d;
    }
    
    .empty-state {
        text-align: center;
        padding: 3rem;
        background-color: white;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.05);
    }
    
    .empty-state i {
        font-size: 3rem;
        color: #dee2e6;
        margin-bottom: 1rem;
    }
    
    .empty-state h3 {
        font-size: 1.5rem;
        color: #343a40;
        margin-bottom: 0.5rem;
    }
    
    .empty-state p {
        color: #6c757d;
        margin-bottom: 1.5rem;
    }
    
    /* Animaciones de entrada */
    @keyframes fadeInUp {
        from { opacity: 0; transform: translate3d(0, 30px, 0); }
        to { opacity: 1; transform: translate3d(0, 0, 0); }
    }
    
    .form-card {
        animation: fadeInUp 0.5s both;
    }
    
    .form-card:nth-child(1) { animation-delay: 0.1s; }
    .form-card:nth-child(2) { animation-delay: 0.15s; }
    .form-card:nth-child(3) { animation-delay: 0.2s; }
    .form-card:nth-child(4) { animation-delay: 0.25s; }
    .form-card:nth-child(5) { animation-delay: 0.3s; }
    
    /* Variables específicas de sección */
    .section-calidad { --section-color-rgb: 13, 110, 253; }
    .section-produccion { --section-color-rgb: 25, 135, 84; }
    .section-mantenimiento { --section-color-rgb: 255, 193, 7; }
    .section-inocuidad { --section-color-rgb: 13, 202, 240; }
    .section-formularios { --section-color-rgb: 108, 117, 125; }
    
    /* Botón flotante de añadir */
    .btn-floating {
        position: fixed;
        bottom: 30px;
        right: 30px;
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background-color: #0d6efd;
        color: white;
        display: flex;
        justify-content: center;
        align-items: center;
        box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        z-index: 1000;
        transition: all 0.3s ease;
    }
    
    .btn-floating:hover {
        transform: scale(1.1);
        box-shadow: 0 8px 25px rgba(0,0,0,0.3);
        background-color: #0b5ed7;
        color: white;
    }
    
    .btn-floating i {
        font-size: 1.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="section-{{ section }}">
    <div class="nav-buttons">
        <a href="{{ url_for('index') }}" class="nav-button">
            <i class="fas fa-home"></i>Inicio
        </a>
        <a href="{{ url_for('line_sections', category=category) }}" class="nav-button">
            <i class="fas fa-layer-group"></i>Secciones
        </a>
        <a href="{{ url_for('section_exercises', category=category, section=section) }}" class="nav-button">
            <i class="fas fa-tools"></i>Herramientas
        </a>
    </div>
    
    <div class="breadcrumb-section">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb">
                <li class="breadcrumb-item"><a href="{{ url_for('index') }}">Inicio</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('line_sections', category=category) }}">{{ category }}</a></li>
                <li class="breadcrumb-item"><a href="{{ url_for('section_exercises', category=category, section=section) }}">{{ section_name }}</a></li>
                <li class="breadcrumb-item active">Formularios</li>
            </ol>
        </nav>
    </div>
    
    <div class="page-header">
        <div class="page-header-bg"></div>
        <div class="page-header-overlay">
            <div class="container py-3">
                <div class="row">
                    <div class="col-md-8">
                        <h1 class="page-title">
                            <i class="fas {{ section_icon }}"></i>
                            Formularios de {{ section_name }} - {{ category }}
                        </h1>
                        <p class="page-description">
                            Gestione los formularios para la línea {{ category }} - sección {{ section_name }}
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="container forms-container">
        {% if forms %}
            <div class="row">
                {% for form in forms %}
                <div class="col-md-6">
                    <div class="card form-card">
                        <div class="form-card-header">
                            <h3 class="form-card-title">{{ form.title }}</h3>
                            <div class="form-card-subtitle">
                                {% if form.is_active %}
                                <span class="badge bg-success">Activo</span>
                                {% else %}
                                <span class="badge bg-secondary">Inactivo</span>
                                {% endif %}
                                <span class="ms-2">Creado: {{ form.created_at.strftime('%d/%m/%Y') }}</span>
                            </div>
                        </div>
                        <div class="form-card-body">
                            <p class="form-card-description">
                                {% if form.description %}
                                    {{ form.description | truncate(150) }}
                                {% else %}
                                    <span class="text-muted">Sin descripción</span>
                                {% endif %}
                            </p>
                            <div class="form-meta">
                                <span><i class="fas fa-question-circle"></i>{{ form.questions | length }} preguntas</span>
                                <span><i class="fas fa-clipboard-list"></i>{{ form.responses | length }} respuestas</span>
                            </div>
                        </div>
                        <div class="form-card-footer">
                            <span class="form-creator">
                                <i class="fas fa-user"></i>
                                {% if form.creator %}
                                    {{ form.creator.username }}
                                {% else %}
                                    Usuario desconocido
                                {% endif %}
                            </span>
                            <div class="form-actions">
                                <a href="{{ url_for('view_form', form_id=form.id) }}" class="btn btn-sm btn-primary action-button">
                                    <i class="fas fa-eye"></i> Ver
                                </a>
                                {% if form.created_by == current_user.id or current_user.is_admin %}
                                <a href="{{ url_for('edit_form', form_id=form.id) }}" class="btn btn-sm btn-warning action-button">
                                    <i class="fas fa-edit"></i> Editar
                                </a>
                                <a href="{{ url_for('view_responses', form_id=form.id) }}" class="btn btn-sm btn-info action-button">
                                    <i class="fas fa-chart-bar"></i> Respuestas
                                </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <i class="fas fa-clipboard"></i>
                <h3>Aún no hay formularios</h3>
                <p>Crea tu primer formulario para esta sección</p>
                <a href="{{ url_for('create_form', category=category, section=section) }}" class="btn btn-primary">
                    <i class="fas fa-plus me-2"></i>Crear Formulario
                </a>
            </div>
        {% endif %}
    </div>
    
    <a href="{{ url_for('create_form', category=category, section=section) }}" class="btn-floating" title="Crear nuevo formulario">
        <i class="fas fa-plus"></i>
    </a>
</div>
{% endblock %}